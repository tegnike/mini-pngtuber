# PNGTuber Simple

音声入力（マイク）を使って、あらかじめ用意した2枚の画像（口が閉じている/開いている）を切り替える簡易 PNGTuber アプリです。ブラウザ上で動作し、しきい値・ヒステリシス・スムージングなどを UI から調整できます。

## 使い方

- サーバー起動
  - Node.js がある環境で以下のどちらかを実行します。
    - `node server.js`
    - または `npm start`
  - 起動後、`http://localhost:3000` にアクセスします。
- ブラウザでマイクの使用を許可してください。
- UI から以下を設定できます。
  - 入力デバイスの選択/更新
  - しきい値（感度）/ヒステリシス（安定化幅）/スムージング（滑らかさ）/入力ゲイン
  - 画像の選択（public フォルダ内の画像が候補として表示）
  - 表示サイズの調整、音量メーターの表示切り替え
  - 背景色の変更（キャラ背景を一色に設定）

## 設定の保存

各種設定（しきい値・ヒステリシス・スムージング・ゲイン・画像選択・表示サイズ・背景色・メーター表示・デバイスID）はローカルストレージに自動保存され、次回起動時に復元されます。

## 画像の配置

- `public/` フォルダ内に口「閉」画像と口「開」画像の2枚を置いてください。
- 例）`mouse_closed.png`（閉）、`default.png`（開）
- ファイル名に `closed` / `close` / `mouth` 等が含まれるものは自動的に「閉」に、`open` が含まれるものは「開」に初期選択されます（任意で変更可）。

## 調整のコツ

- 口が開きっぱなし/閉じっぱなしになるとき:
  - しきい値（感度）を上げ下げしてください。
- パタパタと頻繁に切り替わるとき:
  - ヒステリシスを上げるか、スムージングを上げて安定化させてください。
- 入力デバイス名が表示されないとき:
  - 一度「マイク開始」を押して権限を許可した後、「デバイス更新」を押してください。

## 技術メモ

- サーバーは依存なしの素の Node.js（`http`）で `public/` を配信します。
- `GET /images` で `public/` 内の画像ファイル（png/jpg/jpeg/gif/webp/svg）一覧を返します。
- ブラウザ側は Web Audio API を使い、時系列波形から RMS を算出 → スライダー指定のしきい値とヒステリシスで口の開閉を判定します。

---

不明点や追加要望（ホットキー、透明背景、OBS 連携用の表示最適化など）があれば教えてください。必要に応じて拡張します。
# mini-pngtuber
